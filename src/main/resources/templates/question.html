<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-theme.min.css">
    <script src="/js/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script src="/js/jquery.cookie.js" type="text/javascript"></script>
    <script src="/js/my.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="application/javascript"></script>
    <title th:text="${showQuestion.title}"></title>
</head>
<body background="/img/background.PNG">

<!--引用导航条navigation.html-->
<div th:insert="~{navigation :: nav}"/>

<div class="container-fluid" style="background: white;margin-left: 200px;margin-top: 30px;margin-right: 200px">
    <div class="row">
        <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
            <div>
                <h2 th:text="${showQuestion.title}"></h2>
                作者 <span th:text="${showQuestion.name}+' | 发布于'+${#dates.format(showQuestion.gmtCreate, 'yyyy-MM-dd HH:mm')}+' | 阅读数'+${showQuestion.readCount}"></span>
                <hr>
                <span th:text="${showQuestion.description}"></span>
                <hr>
                <div th:if="${session.user!=null}">
                    <a th:if="${session.user.getName()==showQuestion.name}" th:href="@{'/publish/'+${showQuestion.questionId}}" class="glyphicon glyphicon-pencil" style="color: gray">编辑问题</a>
                </div>
                <br><br><br>
                <h3>0个回复</h3>
                <hr>
                <br><br>
                <div class="media-left">
                    <a href="#">
                        <img class="media-object img-rounded" th:src="${session.user.getPictureUrl()}" style="width: 40px">
                    </a>
                </div>
                <div style="padding-top: 13px" class="media-body">
                    <h5 class="media-heading"><a th:text="${session.user.name}"></a></h5>
                </div>
                <textarea id="content" style="margin: 10px" class="form-control" rows="3"></textarea>
                <input id="qid" type="hidden" th:value="${showQuestion.questionId}">
                <button type="button" class="btn btn-success" style="float: right;margin-bottom: 20px" onclick="publish(1)">发表评论</button>
            </div>
        </div>
        <div style="margin-top: 30px" class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
            <span>发起人</span>
            <br><br>
            <div class="media-left">
                <a href="#">
                    <img class="media-object img-rounded" th:src="${showQuestion.pictureUrl}" style="width: 40px">
                </a>
            </div>
            <div class="media-body">
                <h5 class="media-heading"><a th:text="${showQuestion.name}"></a></h5>
            </div>
            <hr>
            相关问题
        </div>
    </div>
</div>
</body>

<script language="JavaScript" type="text/javascript">

    function publish(type) {
        if (type==1){
            //如果type是1表示是对于问题的评论
            //获取问题的id
            var qid = $("#qid").val();
            //评论内容
            var content = $("#content").val();

            $.ajax({
                url:"/comment",
                type:"post",
                contentType:"application/json",
                data:JSON.stringify({
                    qid:qid,
                    content:content,
                    type:type
                }),
                dataType:"json",
                success:function (result) {
                    if (result.code==1000){
                        //成功
                    }
                }
            })
        }
    }

</script>
</html>
